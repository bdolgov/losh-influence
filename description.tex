\documentclass[12pt, a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{indentfirst}

\begin{document}
{\section{Правила игры}}
Наша версия игры вдохновлена игрой Influence для телефонов на базе Android.

В игру играют одновременно от 2 до 4 игроков, у каждого игрока есть номер от 1 до 4. Игроки ходят по очереди в порядке возрастания номера. Считается, что номер текущего игрока -- это $P$.

Игра ведется на поле, каждая клетка $A$ поля имеет координаты $(coordX_A, coordY_A)$. $0 \le coordX_A \le N, 0 \le coordY_A \le M$.

У каждой клетки поля есть множество соседних клеток ${neigh_A}$. $1 \le |{neigh_A}| \le 6$.

Каждая клетка поля имеет характеристику $size_A$, выражающуюся натуральным числом. $1 \le size_A \le 10^6$.

Размер и координаты соседних клеток являются свойством поля и не изменяются во время одного запуска игры.

У клетки может быть один владелец $owner_A$, либо не быть владельца вообще. $0 \le owner_A \le 4$, при $owner_A = 0$ считается, что клетка не имеет владельца.

У клетки, имеющей владельца, есть сила $power_A$. $0 \le power_A \le size_A$. $power_A = 0$ тогда и только тогда, когда клетка не имеет владельца.

Игроку передаётся информация только о клетках, которыми он владеет, и о клетках, соседствующих с ними.

Цель игры -- захватить максимальное количество клеток.
Для осуществления цели игрок может пытаться захватывать клетки, соседние с теми, которыми он владеет.

Игроки ходят по очереди.

Каждый ход игрока $P$ состоит из двух стадий -- стадии захвата и стадии укрепления.

Один ход стадии захвата -- это пара соседних клеток $A$ и $B$. На клетки накладываются следующие требования:

\begin{itemize}
\item $owner_A = P$
\item $owner_B \neq P$
\item $power_A \ge 2$
\end{itemize}

В случае, если $owner_B = 0$, соседняя клетка сразу переходит во владение игрока $P$, и ей передается почти вся сила, находившаяся в исходной клетке:

\begin{itemize}
\item $owner_B = P$
\item $power_B = \min(size_B, power_A - 1)$
\item $power_A = 1$
\end{itemize}

В противном случае, происходит сражение клеток. Для этого генерируются два числа ($rand(a, b)$ генерирует равномерно распределенное на отрезке $[a, b]$ целое число):

\begin{itemize}
\item $attack_A = \sum \limits_{i=1}^{power_A} rand(1, 6) $
\item $attack_B = \sum \limits_{i=1}^{power_B} rand(1, 6) $
\end{itemize}

Далее, в случае $attack_A > attack_B$, атака считается удачной, и владение клеткой изменяется:

\begin{itemize}
\item $owner_B = P$
\item $power_B = \max(1, power_A - \lceil \frac{attack_B}{6} \rceil)$
\item $power_A = 1$
\end{itemize}

В случае $attack_A = attack_B$, объявляется ничья:

\begin{itemize}
\item $power_A = 1$
\item $power_B = 1$
\end{itemize}

В противном случае атака считается неудачной:

\begin{itemize}
\item $power_A = 1$
\item $power_B = \max(1, power_B - \lceil \frac{attack_A}{6} \rceil)$
\end{itemize}

За стадию захвата можно произвести неограниченное количество ходов захвата.

После стадии захвата начинается стадия укрепления. 

Один ход стадии укрепления -- это клетка $A$. При этом требуется:

\begin{itemize}
\item $power_A < size_A$
\item $owner_A = P$
\end{itemize}

После выполнения хода сила заданной клетки увеличивается на 1:

\begin{itemize}
\item $power_A = power_A + 1$
\end{itemize}

За стадию укрепления игрок может сделать не больше $D$ ходов, где $D$ -- это количество клеток, которыми он владеет после стадии захвата.

После стадии укрепления, игрок передает ход следующему игроку.

Игра заканчивается, если один игрок захватывает все клетки, либо если на протяжении большого количества ходов ситуация на карте не изменялась содержательным образом. Жюри оставляют за собой право трактовать последнюю фразу как угодно.

{\section{Интерфейс взаимодействия}}

Для взаимодействия стратегии с игровой системой предлагается использовать стандартный ввод-вывод.

При первом ходе игрока, ему отправляется приветствие (P -- номер текущего игрока): \texttt{HELLO P}

В любой момент игрок может послать команду \texttt{MAP}, в ответ на неё ему придёт описание карты. Описание карты имеет следующий формат:

На первой строке задано число $K$ -- количество клеток, находящихся в области видимости игрока.

Далее следует $K$ описаний клеток. Каждое описание клетки выглядит следующим образом:

$coordX_A$ $coordY_A$ $size_A$ $owner_A$ $power_A$ $|{neigh_A}|$

Для каждой клетки далее следуют $|{neigh_A}|$ строк, описывающих каждого соседа $B$:

$coordX_B$ $coordY_B$

Далее следуют 4 числа, показывающие, сколькими клетками владеет каждый игрок.

Для начала стадии завоевания, игрок может отправить команду \texttt{BEGIN CONQUEST}. В ответ может придет либо \texttt{OK} -- если игрок может войти в стадию завоевания, либо \texttt{ERROR}, если в данный момент это сделать нельзя (например, если игрок уже находится в стадии завоевания).

Для выполнения одного хода стадии завоевания, нужно отправить команду \texttt{CONQUEST Ax Ay Bx By}. В ответ придёт либо \texttt{ERROR}, если данных ход некорректен, либо результат боя. При успешной атаке, будет возвращено \texttt{SUCCESS Pa Pb}, а в случае проигрыша или ничьей будет возвращено \texttt{FAIL Pa Pb}, где \texttt{Pa} -- это новая сила клетки $A$, а \texttt{Pb} -- новая сила клетки $B$.

После выполнения всех желаемых ходов стадии завоевания, игрок должен перейти в стадию укрепления командой \texttt{BEGIN FORTIFICATION}. В ответ может прийти либо \texttt{OK} -- если игрок может войти в стадию укрепления, либо \texttt{ERROR}, если в данный момент это сделать нельзя (например, если игрок уже находится в стадии укрепления).

Для выполнения одного хода стадии укрепления, нужно отправить команду \texttt{FORTIFY Ax Ay}. В ответ придёт либо \texttt{OK}, либо \texttt{ERROR}.

После выполнения всех желаемых ходов стадии укрепления, игрок должен передать ход другому игроку командой \texttt{PASS}. В ответ придёт \texttt{ERROR}, если ход передать нельзя (например, если игрок еще не прошел стадию завоевания), \texttt{CONTINUE}, если остальные игроки сходили и ход снова вернулся к текущему игроку, \texttt{WIN}, если игрок победил по результатам этого хода, и \texttt{LOST}, если игрок проиграл по результатам ходов противников.
\end{document}
